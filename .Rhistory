data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
library(readxl)
library(dplyr)
library(ggplot2)
library(plyr)
library(plotrix)
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
data_compact_nano <- na.omit(data_compact_nano)
library(nlme)
fit2 <- lme(Comprimento ~ Tratamento*Dia , data = data_compact_nano, random = ~ 1| Repeticao)
plot(fit2)
qqnorm(fit2)
data_compact_nano$Comprimento = log(data_compact_nano$Comprimento, base = 10)
fit2_2 <- lme(Comprimento ~ Tratamento*Dia , data = data_compact_nano, random = ~ 1| Repeticao)
plot(fit2_2) #Os resíduos estão melhores que a variável resposta sem transformação
hist(residuals(fit2_2), freq = F)
teste2 <- residuals(fit2_2)
hist(teste2, freq = F)
qqnorm(teste2)
qqline(teste2, col = 2, lwd=2)
which(teste2 == min(teste2))
teste2[which(teste2 == min(teste2))]
teste2 <- teste2[-which(teste2 == min(teste2))]
hist(teste2, freq = F)
qqnorm(teste2)
qqline(teste2, col = 2, lwd=2)
fit2_2
10^-0.4356544969
library(readxl)
library(dplyr)
library(ggplot2)
library(plyr)
library(plotrix)
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
ggplot(data_compact_nano, aes(Dia, Comprimento, color = Tratamento)) + geom_boxplot(outlier.colour = "red", outlier.shape = 1)
data_compact_nano <- na.omit(data_compact_nano)
View(data_compact_nano)
is.na(data_compact_nano)
table(is.na(data_compact_nano))
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
is.na(data_compact_nano)
table(is.na(data_compact_nano))
prop.table(table(is.na(data_compact_nano))) #quantidade de NA's geral
ggplot(data_compact_nano, aes(Dia, Comprimento, color = Tratamento)) + geom_boxplot(outlier.colour = "red", outlier.shape = 1)
prop.table(table(is.na(data_compact_nano))) #quantidade de NA's geral
data_compact_nano <- na.omit(data_compact_nano)
prop.table(table(is.na(data_compact_nano))) #quantidade de NA's geral
lista1 <- list(0,0,0,0,0,0)
lista2 <- list(0,0,0,0,0,0)
for(i in 1:6){
lista1[[i]] <- rep(0, 9)
for(j in 1:9){
lista1[[i]][j] <- mean( as.data.frame(data_compact_nano %>% filter(Tratamento == paste0(i-1) & Dia==paste0(j-1)))$Comprimento )
lista2[[i]][j] <- sd( as.data.frame(data_compact_nano %>% filter(Tratamento == paste0(i-1) & Dia==paste0(j-1)))$Comprimento )
}
}
suporte <- as.data.frame(cbind(rep(0:8, 6), c(lista1[[1]], lista1[[2]], lista1[[3]], lista1[[4]], lista1[[5]], lista1[[6]]),
c(lista2[[1]], lista2[[2]], lista2[[3]], lista2[[4]], lista2[[5]], lista2[[6]])))
suporte$V1 <- as.factor(suporte$V1)
plot(suporte$V2[1:9],axes=FALSE,ylim=c(0,0.9),cex.lab=1,xlab="Tempo",ylab="Comprimento médio", main = "Gráfico de perfil médio do comprimento")
axis(2,cex.axis=1)
axis(1,1:9,c("1","2","3","4", "5", "6", "7", "8", "9"),cex.axis=1)
plotCI(suporte$V2[1:9],liw=1.96*suporte$V3[1:9]/sqrt(10),uiw=1.96*suporte$V3[1:9]/sqrt(10),pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 1, cex=1)
lines(suporte$V2[1:9],lwd=1)
plotCI(suporte$V2[10:18],liw=1.96*suporte$V3[10:18]/sqrt(10),uiw=1.96*suporte$V3[10:18]/sqrt(10),pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 2,cex=1)
lines(suporte$V2[10:18],lwd=1, col = 2)
plotCI(suporte$V2[19:27],liw=1.96*suporte$V3[19:27]/sqrt(10),uiw=1.96*suporte$V3[19:27]/sqrt(10),pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 3, cex=1)
lines(suporte$V2[19:27],lwd=1, col = 3)
plotCI(suporte$V2[28:36],liw=1.96*suporte$V3[28:36]/sqrt(10),uiw=1.96*suporte$V3[28:36]/sqrt(10),pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 4,cex=1)
lines(suporte$V2[28:36],lwd=1, col = 4)
plotCI(suporte$V2[37:45],liw=1.96*suporte$V3[37:45]/sqrt(10),uiw=1.96*suporte$V3[37:45]/sqrt(10),pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 5,cex=1)
lines(suporte$V2[37:45],lwd=1, col = 5)
plotCI(suporte$V2[46:54],liw=1.96*suporte$V3[46:54]/sqrt(10),uiw=1.96*suporte$V3[46:54]/sqrt(10),pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 6,cex=1)
lines(suporte$V2[46:54],lwd=1, col = 6)
interaction.plot(data_compact_nano$Dia, data_compact_nano$Tratamento, data_compact_nano$Comprimento, las = 1)
install.packages(c("aroma.core", "backports", "BH", "checkmate", "coin", "curl", "data.table", "dplyr", "Formula", "future", "globals", "gridExtra", "knitr", "multcomp", "openssl", "plotrix", "PSCBS", "purrr", "Rcpp", "rlang", "rstudioapi", "sandwich", "scales", "tibble", "tidyr", "tidyselect", "withr"))
install.packages(c("aroma.core", "PSCBS"))
install.packages("car")
install.packages("car")
install.packages("MASS")
install.packages("car")
install.packages("minqa")
install.packages("car")
install.packages("MASS")
require(car)
require(MASS)
?qqp
qqp(data_compact_nano, "norm")
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
?fitdistr
gama <- fitdistr(data_compact_nano$Comprimento, "gamma")
gama
summary(gma)
summary(gama)
gama$estimate
qqp(data_compact_nano$Comprimento, "gamma", shape = gama$estimate[[1]], rate = gama$estimate[[2]])
beta <- fitdistr(data_compact_nano$Comprimento, "beta")
hist(data_compact_nano$Comprimento)
hist(density(data_compact_nano$Comprimento))
hist(density(as.numeric(data_compact_nano$Comprimento)))
density(as.numeric(data_compact_nano$Comprimento))
plot(density(as.numeric(data_compact_nano$Comprimento)))
beta <- fitdistr(data_compact_nano$Comprimento, "chi-squared")
cs <- fitdistr(data_compact_nano$Comprimento, "exponencial")
cs <- fitdistr(data_compact_nano$Comprimento, "exponential")
qqp(data_compact_nano$Comprimento, "exponential", shape = cs$estimate[[1]], rate = cs$estimate[[2]])
cs$estimate[[1]]
cs$estimate[[2]]
cs
qqp(data_compact_nano$Comprimento, "exponential", rate = cs$estimate[[1]])
qqp(data_compact_nano$Comprimento, rate = cs$estimate[[1]])
cs$estimate[[1]]
qqp(data_compact_nano$Comprimento, "cs", rate = cs$estimate[[1]])
qqp(data_compact_nano$Comprimento, "exponential", rate = cs$estimate[[1]])
cs <- fitdistr(data_compact_nano$Comprimento, "log-Normal")
cs
qqp(data_compact_nano$Comprimento, "log-Normal")
qqp(data_compact_nano$Comprimento, "lnorm")
cs$estimate[[1]]
qqp(data_compact_nano$Comprimento, "log-Normal", meanlog = cs$estimate[[1]], sdlog = cs$estimate[[2]])
rm(cs)
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=1,shape2=1))
beta
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=0,shape2=0))
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=0,shape2=1))
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=1,shape2=1))
beta
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
cs <- fitdistr(data_compact_nano$Comprimento, "chi-squared", start = list(shape1=1,shape2=1))
cs <- fitdistr(data_compact_nano$Comprimento, "chi-squared", start = list(shape1=1,shape2=1))
cs <- fitdistr(data_compact_nano$Comprimento, "chi-squared", start = list(df=1))
cs <- fitdistr(data_compact_nano$Comprimento, "chi-squared", start = list(df=2))
cs <- fitdistr(data_compact_nano$Comprimento, "chi-squared", start = list(df=3))
cs <- fitdistr(data_compact_nano$Comprimento, "chi-squared", start = list(df=3), method="Brent",lower=0.1,upper=100)
cs
cs
cs$estimate
qqp(data_compact_nano$Comprimento, "beta", df = cs$estimate[[1]])
cs <- fitdistr(data_compact_nano$Comprimento, "chi-squared", start = list(df=3), method="Brent",lower=0.1,upper=100)
rm(cs)
wb <- fitdistr(data_compact_nano$Comprimento, "weibull")
wb
qqp(data_compact_nano$Comprimento, "weibull", shape = wb$estimate[[1]], scale = wb$estimate[[2]])
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=1,shape=2))
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=1,shape=1))
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=1,shape=0))
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=2,shape=1))
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=5,shape=1))
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=1,shape=1))
qqp(data_compact_nano$Comprimento, "weibull", shape = wb$estimate[[1]], scale = wb$estimate[[2]])
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=1,shape=10))
wb <- fitdistr(data_compact_nano$Comprimento, "weibull", start=list(scale=4,shape=10))
wb <- fitdistr(data_compact_nano$Comprimento, "weibull")
qqp(data_compact_nano$Comprimento, "weibull", shape = wb$estimate[[1]], scale = wb$estimate[[2]])
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=1,shape2=10))
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=1,shape2=1))
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
fitdistr(data_compact_nano$Comprimento, "logistic")$estimate
wb <- fitdistr(data_compact_nano$Comprimento, "weibull")
rm(wb)
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
qqp(data_compact_nano$Comprimento, "gamma", shape = gama$estimate[[1]], rate = gama$estimate[[2]])
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
par(mfrow=c(2,2))
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
qqp(data_compact_nano$Comprimento, "gamma", shape = gama$estimate[[1]], rate = gama$estimate[[2]])
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=1,shape2=1))
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
library(readxl)
library(dplyr)
library(ggplot2)
library(plyr)
library(plotrix)
require(car)
require(MASS)
par(mfrow=c(2,2))
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
gama <- fitdistr(data_compact_nano$Comprimento, "gamma")
qqp(data_compact_nano$Comprimento, "gamma", shape = gama$estimate[[1]], rate = gama$estimate[[2]])
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=1,shape2=1))
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
data_compact_nano %>% filter(Dia==8)
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
data_compact_nano %>% filter(Dia == 8)
num_sum_ovo <- data_compact_nano %>% filter(Dia == 8)
num_sum_ovo <- as.data.frame(data_compact_nano %>% filter(Dia == 8))
num_sum_ovo
num_sum_ovo$Numero_ovos_somados
plot(num_sum_ovo$Numero_ovos_somados)
plot(num_sum_ovo$Numero_ovos_somados)
plot(density(num_sum_ovo$Numero_ovos_somados))
qqp(num_sum_ovo$Numero_ovos_somados, "Poisson")
Ps <- fitdistr(num_sum_ovo$Numero_ovos_somados, "Poisson")
qqp(num_sum_ovo$Numero_ovos_somados, "pois", Ps$estimate)
BN <- fitdistr(num_sum_ovo$Numero_ovos_somados, "Negative Binomial")
qqp(num_sum_ovo$Numero_ovos_somados, "nbinom", size = BN$estimate[[1]], mu = BN$estimate[[2]])
data_compact_nano %>% group_by(Repeticao) %>% mutate(soma=sum(Numero_neonatos))
data_compact_nano %>% filter(Repeticao==R1) %>% mutate(soma=sum(Numero_neonatos))
data_compact_nano %>% filter(Repeticao=="R1") %>% mutate(soma=sum(Numero_neonatos))
data_compact_nano %>% mutate(soma=sum(Numero_neonatos)) %>% group_by(Repeticao)
data_compact_nano %>% mutate(soma=sum(Numero_neonatos)) %>% group_by(Repeticao, Tratamento)
data_compact_nano %>% mutate(soma=sum(Numero_neonatos))
data_compact_nano %>% filter(Tratamento, Repeticao, Numero_neonatos)
data_compact_nano %>% select(Tratamento, Repeticao, Numero_neonatos)
data_compact_nano %>% select(Tratamento & Repeticao & Numero_neonatos)
data_compact_nano %>% select(Dia)
data_compact_nano %>% select(Dia == 1)
data_compact_nano %>% filter(Repeticao=="R1", Tratamento == 0)
(data_compact_nano %>% filter(Repeticao=="R1", Tratamento == 0))[,5]
(data_compact_nano %>% filter(Repeticao=="R1", Tratamento == 0) %>% mutate(soma = sum(Numero_neonatos)))
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
num_sum_ovo <- as.data.frame(data_compact_nano %>% filter(Dia == 8))
plot(density(num_sum_ovo$Numero_ovos_somados))
Ps <- fitdistr(num_sum_ovo$Numero_ovos_somados, "Poisson")
qqp(num_sum_ovo$Numero_ovos_somados, "pois", Ps$estimate)
BN <- fitdistr(num_sum_ovo$Numero_ovos_somados, "Negative Binomial")
qqp(num_sum_ovo$Numero_ovos_somados, "nbinom", size = BN$estimate[[1]], mu = BN$estimate[[2]])
num_sum_ovo$Num_neo_somados
plot(density(num_sum_ovo$Num_neo_somados))
Ps_neo <- fitdistr(num_sum_ovo$Num_neo_somados, "Poisson")
qqp(num_sum_ovo$Num_neo_somados, "pois", Ps_neo$estimate)
BN_neo <- fitdistr(num_sum_ovo$Num_neo_somados, "Negative Binomial")
qqp(num_sum_ovo$Num_neo_somados, "nbinom", size = BN_neo$estimate[[1]], mu = BN_neo$estimate[[2]])
rm(BN_neo)
plot(num_sum_ovo$Num_neo_somados)
data_compact_nano %>% filter(Dia==8)
data_compact_nano %>% filter(Tratamento==0)
data_compact_nano %>% filter(Tratamento==0, Repeticao=="R1")
data_compact_nano %>% filter(Tratamento==0, Repeticao=="R2")
data_compact_nano %>% filter(Tratamento==3, Repeticao=="R2")
data_compact_nano %>% filter(Tratamento==0, Repeticao=="R1")[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R1"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R2"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R3"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R4"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R5"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R6"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R7"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R8"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R9"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R10"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R1"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R1"))[,4]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R2"))[,4]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R10"))[,4]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R1"))[,4]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R10"))[,4]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R10"))[,4]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R1"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R2"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R3"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R4"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R5"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R6"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R7"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R8"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R9"))[,5]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R10"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R1"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R2"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R3"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R4"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R5"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R6"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R7"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R8"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R9"))[,5]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R10"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R1"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R2"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R3"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R4"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R5"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R6"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R7"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R8"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R9"))[,5]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R10"))[,5]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R1"))[,5]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R2"))[,5]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R1"))[,5]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R1"))
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R1"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R1"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R2"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R3"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R4"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R5"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R6"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R7"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R8"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R9"))[,6]
(data_compact_nano %>% filter(Tratamento==0, Repeticao=="R10"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R1"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R2"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R3"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R4"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R5"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R6"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R7"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R8"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R9"))[,6]
(data_compact_nano %>% filter(Tratamento==1, Repeticao=="R10"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R1"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R2"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R3"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R4"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R5"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R6"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R7"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R8"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R9"))[,6]
(data_compact_nano %>% filter(Tratamento==2, Repeticao=="R10"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R1"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R2"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R3"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R4"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R5"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R6"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R7"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R8"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R9"))[,6]
(data_compact_nano %>% filter(Tratamento==3, Repeticao=="R10"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R1"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R2"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R3"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R4"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R5"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R6"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R7"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R8"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R9"))[,6]
(data_compact_nano %>% filter(Tratamento==4, Repeticao=="R10"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R1"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R2"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R3"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R4"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R5"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R6"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R7"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R8"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R9"))[,6]
(data_compact_nano %>% filter(Tratamento==5, Repeticao=="R10"))[,6]
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
num_sum_ovo <- as.data.frame(data_compact_nano %>% filter(Dia == 8))
Ps <- fitdistr(num_sum_ovo$Numero_ovos_somados, "Poisson")
qqp(num_sum_ovo$Numero_ovos_somados, "pois", Ps$estimate)
BN <- fitdistr(num_sum_ovo$Numero_ovos_somados, "Negative Binomial")
qqp(num_sum_ovo$Numero_ovos_somados, "nbinom", size = BN$estimate[[1]], mu = BN$estimate[[2]])
plot(num_sum_ovo$Num_neo_somados)
Ps_neo <- fitdistr(num_sum_ovo$Num_neo_somados, "Poisson")
qqp(num_sum_ovo$Num_neo_somados, "pois", Ps_neo$estimate)
num_sum_ovo$Num_neo_somados
BN_neo <- fitdistr(num_sum_ovo$Num_neo_somados, "Negative Binomial")
qqp(num_sum_ovo$Num_neo_somados, "nbinom", size = BN_neo$estimate[[1]], mu = BN_neo$estimate[[2]])
par(mfrow=c(2,1))
qqp(num_sum_ovo$Numero_ovos_somados, "pois", Ps$estimate)
par(mfrow=c(1,2))
qqp(num_sum_ovo$Numero_ovos_somados, "pois", Ps$estimate)
qqp(num_sum_ovo$Numero_ovos_somados, "nbinom", size = BN$estimate[[1]], mu = BN$estimate[[2]])
qqp(num_sum_ovo$Numero_ovos_somados, "pois", Ps$estimate)
qqp(num_sum_ovo$Numero_ovos_somados, "nbinom", size = BN$estimate[[1]], mu = BN$estimate[[2]])
qqp(num_sum_ovo$Num_neo_somados, "pois", Ps_neo$estimate)
qqp(num_sum_ovo$Num_neo_somados, "nbinom", size = BN_neo$estimate[[1]], mu = BN_neo$estimate[[2]])
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
ggplot(data_compact_nano, aes(Dia, Comprimento, color = Tratamento)) + geom_boxplot(outlier.colour = "red", outlier.shape = 1)
prop.table(table(is.na(data_compact_nano))) #quantidade de NA's geral
data_compact_nano <- na.omit(data_compact_nano)
prop.table(table(is.na(data_compact_nano))) #quantidade de NA's geral
ggplot(data_compact_nano, aes(Dia, Comprimento, color = Tratamento)) + geom_boxplot(outlier.colour = "red", outlier.shape = 1)
data_compact_nano %>% filter(Tratamento == 0 & Dia == 0)
data_compact_nano %>% filter(Tratamento == 2 & Dia == 7)
lista1 <- list(0,0,0,0,0,0)
for(i in 1:6){
lista1[[i]] <- rep(0, 9)
for(j in 1:9){
lista1[[i]][j] <- mean( as.data.frame(data_compact_nano %>% filter(Tratamento == paste0(i-1) & Dia==paste0(j-1)))$Comprimento )
#lista2[[i]][j] <- sd( as.data.frame(data_compact_nano %>% filter(Tratamento == paste0(i-1) & Dia==paste0(j-1)))$Comprimento )
}
}
suporte <- as.data.frame(cbind(rep(0:8, 6), c(lista1[[1]], lista1[[2]], lista1[[3]], lista1[[4]], lista1[[5]], lista1[[6]]),
c(lista2[[1]], lista2[[2]], lista2[[3]], lista2[[4]], lista2[[5]], lista2[[6]])))
suporte
5*9
6*9
suporte$V1 <- as.factor(suporte$V1)
plot(suporte$V2[1:9],axes=FALSE,ylim=c(0,0.9),cex.lab=1,xlab="Tempo",ylab="Comprimento médio", main = "Gráfico de perfil médio do comprimento")
axis(2,cex.axis=1)
axis(1,1:9,c("1","2","3","4", "5", "6", "7", "8", "9"),cex.axis=1)
plotCI(suporte$V2[1:9],liw=0,uiw=0,pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 1, cex=1)
lines(suporte$V2[1:9],lwd=1)
plotCI(suporte$V2[10:18],liw=0,uiw=0,pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 2,cex=1)
lines(suporte$V2[10:18],lwd=1, col = 2)
plotCI(suporte$V2[19:27],liw=0,uiw=0,pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 3, cex=1)
lines(suporte$V2[19:27],lwd=1, col = 3)
plotCI(suporte$V2[28:36],liw=0,uiw=0,pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 4,cex=1)
lines(suporte$V2[28:36],lwd=1, col = 4)
plotCI(suporte$V2[37:45],liw=0,uiw=0,pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 5,cex=1)
lines(suporte$V2[37:45],lwd=1, col = 5)
plotCI(suporte$V2[46:54],liw=0,uiw=0,pch=19,add=TRUE,cex.lab=1,slty=1,lwd=2, col = 6,cex=1)
lines(suporte$V2[46:54],lwd=1, col = 6)
suporte
for(i in 1:6){
lista1[[i]] <- rep(0, 9)
for(j in 1:9){
lista1[[i]][j] <- mean( as.data.frame(data_compact_nano %>% filter(Tratamento == paste0(i-1) & Dia==paste0(j-1)))$Comprimento )
}
}
View(fitdistr())
View(fitdistr
)
fitdistr(rpois(1000, 2), "Poisson")
fitdistr(rpois(1000, 2), "Poisson")
set.seed(1)
fitdistr(rpois(1000, 2), "Poisson")
fitdistr(rpois(1000, 2), "Poisson")
fitdistr(rpois(1000, 2), "Poisson")
fitdistr(rpois(1000, 2), "Poisson")
qqp(rpois(1000, 2), "pois", fitdistr(rpois(1000, 2), "Poisson")$estimate)
qqp(rpois(1000, 2), "pois", fitdistr(rpois(1000, 2), "Poisson")$estimate)
qqp(rpois(1000, 2), "pois", fitdistr(rpois(1000, 2), "Poisson")$estimate)
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
gama <- fitdistr(data_compact_nano$Comprimento, "gamma")
data_compact_nano <- as.data.frame(read_excel("./dados/nanoparticulas_dadosR.xlsx"))
data_compact_nano$Tratamento <- as.factor(data_compact_nano$Tratamento)
data_compact_nano$Comprimento <- as.numeric(data_compact_nano$Comprimento)
data_compact_nano$Dia <- as.factor(data_compact_nano$Dia)
data_compact_nano$Repeticao <- as.factor(data_compact_nano$Repeticao)
data_compact_nano <- na.omit(data_compact_nano)
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
gama <- fitdistr(data_compact_nano$Comprimento, "gamma")
gama
View(fitdistr)
gama <- fitdistr(data_compact_nano$Comprimento, "gamma", start = list(shape=1,rate=1))
gama <- fitdistr(data_compact_nano$Comprimento, "gamma")
beta <- fitdistr(data_compact_nano$Comprimento, "beta", start = list(shape1=1,shape2=1))
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
par(mfrow=c(2,2))
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
qqp(data_compact_nano$Comprimento, "gamma", shape = gama$estimate[[1]], rate = gama$estimate[[2]])
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
?glmmPQL
gama <- fitdistr(data_compact_nano$Comprimento, "gamma")
qqp(data_compact_nano$Comprimento, "gamma", shape = gama$estimate[[1]], rate = gama$estimate[[2]])
qqp(data_compact_nano$Comprimento, "beta", shape1 = beta$estimate[[1]], shape2 = beta$estimate[[2]])
qqp(data_compact_nano$Comprimento, "norm")
qqp(data_compact_nano$Comprimento, "lnorm")
pql <- glmmPQL(Comprimento ~ Tratamento*Dia, ~1 | Repeticao, family = gamma(), data = data_compact_nano, verbose = F)
pql <- glmmPQL(Comprimento ~ Tratamento*Dia, ~1 | Repeticao, family = gamma(link = "inverse"), data = data_compact_nano, verbose = F)
pql <- glmmPQL(Comprimento ~ Tratamento*Dia, ~1 | Repeticao, family = gamma(), data = data_compact_nano, verbose = F)
pql <- glmmPQL(Comprimento ~ Tratamento*Dia, ~1 | Repeticao, family = gaussian(), data = data_compact_nano, verbose = F)
plot(pql)
pql <- glmmPQL(Comprimento ~ Tratamento*Dia, ~1 | Repeticao, family = Gamma(), data = data_compact_nano, verbose = F)
plot(pql)
summary(pql)
beta
pql <- glmmPQL(Comprimento ~ Tratamento*Dia, ~1 | Repeticao, family = Gamma(), data = data_compact_nano, verbose = F)
pql
mean(data_compact_nano$Comprimento)
fit3 <- geeglm(Comprimento ~ Tratamento*Dia, family = Gamma() ,id = Repeticao, data = data_compact_nano)
library(geepack)
fit3 <- geeglm(Comprimento ~ Tratamento*Dia, family = Gamma() ,id = Repeticao, data = data_compact_nano)
fit3
plot(fit3)
plot(fit3$residuals)
plot(fit3$residuals)
fit3$y
head(data_compact_nano$Comprimento)
fit3 <- geeglm(Comprimento ~ Tratamento*Dia,id = Repeticao, data = data_compact_nano)
plot(fit3$residuals)
?geeglm
